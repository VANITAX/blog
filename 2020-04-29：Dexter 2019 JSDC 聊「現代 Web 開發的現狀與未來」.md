# Dexter 2019 JSDC 聊「現代 Web 開發的現狀與未來」
## Dexter.Yy 字節跳動 Web 開發引擎負責人
## https://twitter.com/dexteryy
### https://zhuanlan.zhihu.com/p/88616149


一個現象是「互聯網產品」開發的分工模式在發生改變
- 傳統上的分工是『水平分工』
  - 前端開發者負責開發所有產品或程序中的前端部分
  - 後端開發者負責所有後端部分
  - 在有些團隊和產品領域里，認為全棧開發者可以同時負責這兩層


新分工模式是『垂直分工』
- 把人類和機器看成兩個極端，在之間畫一條光譜，
- 每個頻段里的開發者，掌握的技術和關心的問題，都差別非常大
- 每個頻段里都可能有客戶端部分和服務器端部分，但對相關技術的要求不完全一樣

一個應用開發者可以為『面向人類』的產品
- 開發專用的服務器端 API（BFF）
- 但通常不會同時精通 NLP 和能用最專業的姿勢開發分布式日志處理系統

一個分布式基礎設施開發者
- 可以在工具支持下為自己的系統添加簡單的界面
- 但通常不適合開發用戶體驗要求高的大型 SaaS 應用

![e9a002054a0ec1e157842d728e8bba7e_720w](https://pic3.zhimg.com/80/v2-e9a002054a0ec1e157842d728e8bba7e_720w.jpg)

這種分工模式除了
- 要求『前端開發者』成為『應用開發者』，使用更完善的 GUI 軟件開發技術和工具

還衍生出來一個問題是：
- **如何提供工具讓其他垂直領域的開發者能自主搭建應用，滿足這個領域中的簡單 UI 需求**

新分工模式下的應用開發者要掌握『現代 Web 開發』技術，這種技術的特征是：
- 不像傳統 Web 開發以服務器端為主體、前端是後端 Web 框架中的一部分
- 現代 Web 開發是以 client 端為主體
  - 而後端部分比如 SSR、BFF、Serverless 可以成為前端框架中的一部分


但在這種情況下
- 很多開發者都在抱怨另一個現象『JS 疲勞』
- 認為 JS 發展的太快，新技術、新開源項目層出不窮，開發者覺得心很累

今天我們再回頭看這個問題，仍然有很多抱怨和困惑，但已經改善很多  
- 現代 Web 開發的很多主流領域，技術方案已經開始穩定下來，有了明顯的勝出者

我要分享的內容分成兩部分
- 先看一些『**現狀**』
- 再看『**未來**』

## 現況
近年來，出現三個重大問題，引發了很多討論

### 第一個重大問題:『大分裂』
- 『前端開發者』正在分裂成沒有共同語言的兩個群體、完全不同的兩個世界

感受最強烈的有兩類人群：
- 一類是很多年前開始以前端開發者的身份工作，並且滿足於當時的工作方式和工作內容
- 另一類是因為對用戶體驗、UI 設計、動畫、可訪問性等問題感興趣而成為前端開發者

從他們的角度來看待這個問題會更容易理解，對他們來說
- 『前端開發者』這個詞已經完全變成另一種含義，對應的是一套完全不同的技能體系和思維方式

『前端開發者』這個詞，現在都主要指圖中左邊的技能體系  
![786a6c4a0064b58fba3c1aa9f55a8e31_720w](https://pic2.zhimg.com/80/v2-786a6c4a0064b58fba3c1aa9f55a8e31_720w.jpg)

右邊的開發者眼里，『前端開發』現在
- 變得完全以 JS 為中心
- 需要掌握很多以前只有後端才需要掌握的編程知識
  - 比如架構原則、API設計、數據模型等

曾經只要用 HTML、CSS 和少量 JS 交互就能創建 Web 界面
- 而這種工作現在變得覆雜到不可理解
- 他們不理解為什麼左邊的人認為只會寫 JS 是可以的
  - 只會寫 HTML 和 CSS 卻不可以

他們覺得自己作為專家
- 卻要被左邊的人指手畫腳，被強迫以左邊的方式來工作

這些困惑和分歧並不能被前面提到過的『新分工模式』解決
- **仍然要面對如何協調左右兩種思維方式和工作領域的問題**

### 第二個重大問題:『大困境』
指的是整個互聯網行業**一直致力於在設計師和開發者之間『搭建橋梁』、跨越鴻溝**
- 讓設計師的輸出物能成為互聯網產品的『唯一權威來源（Single Source of Truth）』
- 讓設計能在最終產品中被精確的還原

因此設計工具層出不窮越來越多
- 從 Photoshop 發展到 Sketch 再到 Figma，還有 Zeplin、InVision、Abstract 等等

設計師跟開發者一樣要不斷學習新工具
- 但是為『橋梁』付出了這麼多，**最主要的鴻溝和問題卻始終存在**


『大困境』的根源可能是
- 我們的努力目標和解決方法本身有問題，也就是左側圖中的模式

![af0c62bae97cb8d6a130b1d6923cee78_720w](https://pic1.zhimg.com/80/v2-af0c62bae97cb8d6a130b1d6923cee78_720w.jpg)

大家是在現有的分工模式中做改進，在這種分工里
- 設計師的輸出物無論如何都只能是最終產品的一種『效仿』，跟最終產品之間是割裂的

也許只有
- 當我們承認程式碼才是最終產品本身，把程式碼作為唯一權威來源，去解決如何讓各種分工一起圍繞著程式碼來工作，才能徹底逃脫這個『大困境』


### 第三個重大問題:『大對決』
指的是『開發者體驗』（DX）和『用戶體驗』（UX）之間的矛盾
- 一部分前端開發者認為現在的工具鏈已經覆雜到不可理解、難以使用  
- 而對另一部分前端開發者來說，這些現代 Web 開發領域中的工具反而極大的增強了他們的能力
  - 也大幅提升了他們的開發者體驗

但與此同時
- 用戶體驗的很多方面卻沒有以同樣的速度發生進步，有的甚至倒退了
  - 比如 Web 項目的依賴龐大，訪問 Web 產品時需要下載的文件越來越大

而如果在每個局部都應用最佳實踐，兼顧開發者體驗和用戶體驗
- 卻反過來會導致需要大量配置和調優，開發工作變得覆雜，開發者體驗受損

## 應用形態發展
接下來，看下應用形態發展成了什麼樣子
- 早在移動互聯網爆炸式發展之前，連線雜志就指出傳統 Web 已死，而互聯網會永生


既然 Web 是過時模式，App 才是未來
- 業界就開發了海量的 App 來解決線上線下方方面面大大小小的需求
- 我所在的公司字節跳動就非常擅長開發 App，被稱作『App 工廠


但大家知道，幾乎所有市場調查都表明
- 平均每個用戶的手機上，大概只會保持安裝 35個左右的 App
- 也就是說，是只能接觸其中很小一個局部，或只能跟很小一個局部保持聯系

我一直在拿自己做實驗
- 我的手機上常年保持 2000 多個 App
- 如果要記住這 2000個 App，在有需要的時候，快速找到最能滿足需求的app，必然會造成很大的『認知負擔』

所以我在實踐中形成了一套方法
- 我對所有 App 做了多級的樹狀分類
  - 手機每一屏是一個『一級類別』
  - 比如第二屏是『線下生活』
  - 第三屏是『消費』
  - 第四屏是『金融』

然後每一屏由『二級類別』組成
- 按從左到右、從上到下的流式順序，每個類別都占據一個連續的空間，有一個自己的目錄放在最後
- 而最常用的 App 會從目錄中拖出來放到目錄前面，相當於快捷入口
- 功能接近的 App 會連續排列在一起，形成『三級類別』

最後就形成這種結構  
![6dc9245a6fd076dda69e51d366d6527f_720w](https://pic4.zhimg.com/80/v2-6dc9245a6fd076dda69e51d366d6527f_720w.jpg)

這種使用 App 的方法
- 實際上重現了 Web 的早期發展：2000 年前後的時候，門戶網站正是用這種多級樹狀分類的方法，成為了互聯網的入口

但區別是
- 在那個年代，可以由門戶網站來統一維護這些分類，把大量網站都收錄和連接起來
- 而現在市場上扮演類似角色的『超級 App』，並不能把大量 App 連接起來
  - 只能把這些 App 的功能都自己做一遍，做到自己內部

如果要享受到市場上各種獨立 App 帶來的好處
- 只能像我這樣對它們做手動管理


所以如果要充分利用這些 App 的能力
- 就會形成一套像物種分類一樣層級很深的分類系統
- 這樣就會出現一個問題：**最理想的用戶入口在哪？**

傳統上，是以『品牌』為入口
- 但很多時候用戶只有粗略的需求，比如我就是要吃飯，並不會刻意尋找某個品牌

這種時候，理想的入口是靠近層級頂部的
- 現在市場的『超級 App』，就都在向這個方向發展，**讓自己成為盡可能靠近層級頂部的平台**

不過它們越是朝這個方向發展
- 其實也會越接近桌面時代的瀏覽器，成為一個『Web 平台』
- 這個時候理想的入口是靠近層級底部，能直接抵達『內容』或『服務』本身
  - 而不用先打開 App，再一層層找下去，最好也不需要事先安裝這個 App

所以現在大家可以發現：實際上 Web 沒有死
- 入口通常是它們提供的『服務』或『內容』本身，而這種入口，其實就是 Web 的本質
- 想要提供這種入口能力，要麼使用或發展標準的 Web 技術，要麼暫時用非標準的私有實現
- 但隨著發展演化，注定還是會向 Web 標準靠攏


一個例子是，在國際市場的兩種主流方案：
- PWA 側重提供『服務』，使用和發展了標準的 Web 技術
- AMP 側重提供『內容』，它使用了部分非標準的私有實現
  - AMP 這種模式引起了很多爭議，Google 已經在逐步把 AMP 的能力引入到 Web 標準里，讓標準 Web 具備 AMP 的能力


另一個例子是
- 中國市場上流行的小程序，小程序其實也是 Web 的一種非標準的私有實現
  - 但它更針對那些提供『服務』的商家（特別是中小商家、線下商家）
  - 直接綁了上層的 MVVM 開發框架和工具
    - 讓這些商家可以輕易開發出能提供原生 App 體驗的『Web』


隨著發展演進
- 小程序也注定要向 web 標準靠攏，今年在北京就組織了這樣的標準化研討會

## Web Runtime 解決方案
所有這些解決方案，可以通稱為 Web Runtime 解決方案
- 第一類是 Open Web 平台，提供最標準化的技術
  - 包括 Web 引擎（JS 和 WebAssembly 是 Web 引擎的原生語言）、Web API 和渲染引擎
- 第二類是『增強版 WebView（Enhanced WebView）』
  - 在第一類的基礎上，提供自定義的 API 和自定義的 UI 渲染後端
- 第三類可以稱作『加速版移動 Web（Accelerated Mobile Web）』
  - AMP 和小程序表面上差別很大，本質上都屬於這個類別
- 四類和第五類是基於開發工具的解決方案：
  - 一種是 React Native 風格，基於 bridge 和 JS 線程
  - 另一種是 Flutter 風格，基於 AOT 編譯。
- 第六類是適合桌面平台的解決方案，把 Node.js Runtime 和 Web 平台打包在一起

前面說的應用形態、App 和 Web 的關系
- 都主要側重移動平台

而且雖然移動互聯網的市場規模遠遠超過桌面互聯網時代
- 但桌面平台上的應用開發需求不但沒有衰弱，反而也大幅增加了

在中國，對這些需求有一個獨特的稱呼，叫做『中台應用』
- 這個詞其實一定程度上能體現這種需求增加的本質

桌面應用需求的穩定和增加，還有一個原因是：
- 在生活、工作和創造活動中使用的生產力應用，需要效率更高、更沈浸式的用戶界面
  - 所以需要類似桌面電腦、平板這樣的平台

這種對沈浸式用戶界面的需求，不會因為移動設備的流行而減弱
- 而且如果這種 UI 足夠強大，它會不但適合工作，也適合社交和娛樂
- 今年 Facebook 發布了 Horizon，是一個 VR 社交應用，能讓我們看到應用形態的一些新的可能性

但這種類似《黑客帝國》的產品，也容易引發不信任，很多人擔心由 Facebook 這樣的科技巨頭控制的產品，越是包羅萬象無處不在，越是能替代真實世界，就越容易獲取個人隱私，會強迫用戶看到更多廣告，等等

## 開發工具
開發工具這個領域在近幾年其實已經發展成一個熱門投資領域
- 湧現出很多基於開源項目、Web App 或雲服務的初創公司

通過幾個典型的融資事件來體現這種發展
- 去年 5 月，`Prisma` 獲得**種子輪 450 萬美元**的投資
  - Prisma 能為各種數據庫自動生成 GraphQL API Gateway，讓應用開發者可以直接在客戶端或者 BFF 中編寫業務邏輯，不需要依賴專業後端開發者提供圍繞數據層的微服務
- 接著 10 月，`Netlify` 融到 **B 輪 3000萬美元**
  - Netlify 已經發展成國際上最主流的靜態 Web 部署平台
  - 提供便捷、Serverless 的開發者體驗，也為用戶提供最快的訪問速度
- 同樣 10 月，`Replit` 獲得**種子輪 450 萬美元**的投資
  - 這是在線開發環境，為 60 多種語言或框架提供 WebIDE、終端甚至在線開發原生圖形界面的功能
  - 開發者可以不用在本地機器上安裝這些開發環境和調試工具
- 今年 7 月，同樣提供在線開發環境的 `CodeSandbox` 獲得**種子輪 240 萬美元**的投資
  - 這個平台只支持 JS 和 Web 開發，但是提供了更好的框架集成
  - 開發者可以打開瀏覽器就直接編寫基於框架和編譯工具的程式碼，立刻看到效果，不用搭建和配置環境
- 同樣 7 月，`Glitch` 也獲得 **A 輪 3000 萬美元**的投資
  - Glitch 也是一個專注於 JS 和 Web 開發的在線開發環境，致力於降低現代 web 開發的門檻
  - 讓寫現代 Web 像以前寫 HTML、CSS 一樣方便直觀
- 到了 9 月，`Gatsby` 獲得 **A 輪 1500 萬美元**的投資
  - Gatsby 已經發展成目前國際上最主流的建站解決方案
  - 對傳統的基於 CMS 的解決方案比如 Wordpress 造成嚴重威脅
  - 所以 Wordpress 今年也做了巨大的革新

傳統 CMS 在衰弱，Headless CMS 卻越來越流行
- 這個月提供 Headless CMS 服務的 `Strapi` 剛剛獲得**種子輪 400 萬美元**的投資

應用形態的發展、開發工具的發展，這些現狀既是進步，帶來很多能力，解決很多問題
- 同時也提出了很多新問題

目前湧現的幾個趨勢中已經包含這些問題的解決辦法，這些趨勢都已經在發展中，是正在發生的未來

# 正在發生的未來
## 一個趨勢: 『內容開發』和『應用開發』之間的融合

前面提到『前端開發』發生了『大分裂』，這種分裂的根源之一是：  
『前端開發』原本是在傳統 Web 開發中
- 為偏重『內容』的部分寫程式碼
  - 這些『內容』是後端 Web 應用的『輸出物』
  - 因為主要業務邏輯在後端，所以原始的 HTML、CSS 和少量 JS 就能滿足需求
  - 要考慮的問題也圍繞『內容』，比如可訪問性等等

而在現代 Web 開發中，『前端開發者』
- 是負責寫應用的人
- 要考慮整個 GUI 軟件完整生命周期中所有問題
- 而且由於這些應用已經是客戶端應用，不可能再向其他地方輸出『內容』
- 需要在自己內部展現『內容』
- 所以『前端開發者』也仍然要負責『內容』的視覺、交互、可訪問性等問題

『大分裂』的本質是：
- 把『前端開發者』這個分工，照搬到『現代 Web 開發』中，導致這個分工需要同時負責『應用』和『內容』兩方面的事情

而事實上
- 多數人只會擅長和偏好其中一種，要麼成為嚴肅的『軟件開發工程師（SDE）』
- 要麼成為用戶體驗和內容方面的專家

『現代 Web 開發』中的『前端開發』，根本就不是一個工種
- 而是兩個工種

近幾年的技術發展和生態建設
- 都是圍繞如何讓『應用開發者』做好自己的工作，取得了很大進步

現在的問題是
- 不能把這套東西照搬給其他工種
- 同時也不能只是維持他們過時的工作方式

需要提供新工具，讓他們融入到『現代 Web 開發』的新範式中  

Brad Frost 指出其中一個工具就是現在發展相對成熟的『UI 組件』
- 可以對組件做分層，把偏視覺、交互、內容、可訪問性的這一層交給其他分工去產出，成為『可消費的 UI 組件』
- 這種組件可以成為『大分裂』中的橋梁

現代 Web 開發的發展，也在為這種新分工、新工具提供支持
- Gatsby 之所以能成為主流解決方案，拿到大筆融資，很大程度上是因為它體現了 Content Mesh 這個趨勢，可以翻譯成『內容網格化』或『網狀內容』

在傳統 Web 開發喜歡采用的 CMS 架構中
- 數據、內容編輯、內容展現、業務邏輯、托管交付，都是混在一起的，必須用一套方法來提供
- 就好像用了 Wordpress，技術棧和部署托管都避不開 php，客戶端部分也必須基於 Wordpress 主題

而在現代 Web 開發里
- 每個不同的部分都有各自最合適的解決方案，其中很多都有可覆用的、更專業的服務
- 類似中國說的『中台』的概念
  - 不過這些『中台』不僅限於在大型企業內部覆用，而是面向公開市場提供服務

比如
- 表單問卷需求可以用 BaaS 服務 TypeForm 解決
- 用戶授權鑒權可以用 BaaS 服務 Auth0
- 圖文內容可以直接用 Markdown
- 支付可以用 Stripe

所以現代 Web 開發中的應用
- 不是一套技術解決方案，是多種混搭在一起的，在每個問題上，都應該能用最合適的方案和工具

## 發展趨勢是簡化成兩大塊
雖然是混搭，但從架構上看
- 一塊是現代 Web 應用本體
- 一塊是 Serverless 平台
  - 其中又可以簡化為兩大塊：『交付雲』和『後端雲』
    - 『交付雲』支持靜態 Web 部署，支持邊緣計算，也可以支持 SSR 部署，SPR 部署等
    - 『後端雲』由 BaaS + FaaS 組成，既可以取代現代 Web 項目中的 BFF 部分，簡化開發
      - 也可以直接取代很多微服務的開發需求，而 GraphQL API 可以讓它的能力和適用面大幅增強

假如一個 Web 項目只有 React 組件程式碼，它就只是一個 UI 和內容展現
- 正是因為加上了『應用架構』，才從 UI 和內容變成了 GUI 軟件應用
- 後面還會提到『應用架構』里應該有哪些東西


要讓其他分工可以更高效的獨立提供這些 UI 組件，需要進一步的工具支持
- 直接讓 designer 使用依賴管理、編譯工具、CLI 工具等面向軟件開發工程師的工具鏈，是門檻很高、很痛苦的
- 所以需要從『語言和框架』這個點之後開始提供工具

首先是 CASE 工具（Computer Aided Software Engineering，也就是『計算機輔助軟件工程』）
- 把工程和軟件設計中的最佳實踐、數據可視化和常用操作，封裝到圖形界面、免安裝的工具里
- 屏蔽底層技術細節的覆雜性

![Umbrello_1](https://upload.wikimedia.org/wikipedia/commons/1/16/Umbrello_1.png)  

更進一步是提供
- 低程式碼工具（Low-code），讓有些工作不需要寫程式碼也能完成

從這里開始，就已經進入了前面說過的『設計工具』的範疇
- 開始同時解決『大困境』問題，我們這里提供的不再是傳統上基於圖像的設計工具
- 不再是只能設計出『效仿』最終產品的輸出物，不再需要『在設計和開發之間架設橋梁』
  - 而是把程式碼作為『唯一權威來源』，讓各個分工都圍繞著程式碼來協作

最理想的解決方案是
- 提供無程式碼工具（No-code），即使不懂技術、寫不了任何程式碼，也能融入到工作流中

在這個方面
- 遊戲開發作為一種垂直領域的應用軟件開發，比通用的應用軟件開發要領先數年
- 遊戲設計師可以用『關卡編輯器』這樣的工具，低程式碼或無程式碼的產出最終產品的程式碼
- 跟工程師寫的程式碼無縫集成，所有分工都圍繞著同一套最終產品的程式碼來協作

![8c92736008c9804afa17cef3bd4f867f_720w](https://pic4.zhimg.com/80/v2-8c92736008c9804afa17cef3bd4f867f_720w.jpg)  

現代 Web 開發要實現「像遊戲開發領域這樣高效、順暢的工作流」的話
- 趨勢上一定會發展出像遊戲引擎一樣的工具套件，形成新的分工模式
- 所有分工都圍繞著同一套工具、同一套程式碼來協作

![20f6416869edcd8b289e8b9329fb9b3a_720w](https://pic3.zhimg.com/80/v2-20f6416869edcd8b289e8b9329fb9b3a_720w.jpg)  

## 第二個趨勢: 解決『開發者體驗』（DX）和『用戶體驗』（UX）之間關系的問題

JS 擁有所有語言中最龐大最繁榮的 npm 生態
- 有海量的『庫』可以在程式碼里調用
- 這些庫通常會專注於單一目的，提供強大靈活的 API
- 在實現目的的同時，滿足需求和場景的各種變化

這些庫提供的是單塊積木，可以自由組裝成我們想要的樣子  

而『框架』是另一種類型的基礎生態
- 可以說一個現代 web 應用的框架，就是應用本身，框架不是積木

無論庫還是框架
- 如果要把 DX 和 UX 同時做到最優，組裝、配置、開發工作都會變得很繁瑣低效
- **大量注意力不能放在真正的業務需求上，而是被庫和框架的底層技術細節占用**
  - 由於成本高，相關的基礎建設也很容易在技術選型和排優先級的時候被忽略或推遲

這是 JS 生態在積木穩定之後，面臨的一個主要問題
- Meta-framework（元框架），也就是『框架的框架』，正是為此而生

## 元框架(Meta-framework)功能上的趨勢
### 第一個功能: 支持『混合語言開發』

近年來非常明顯的趨勢是，TypeScript 已經成為主流語言  
，TypeScript 雖然解決了很多重要問題，但現代 web 開發領域中還有很多問題，解決方案都在 TypeScript 社區之外

由於以前 TypeScript 社區跟 JS 社區是有些割裂的
- 所以有人形容用 TypeScript 做項目是要交 『TypeScript 稅』的
- 比如無法使用 JS 生態中的某些方案

總體來算，ROI 甚至可能是負的  

TypeScript 官方自己也能認識到這個問題
- 開始積極跟 JS 社區融合
- 比如廢棄 TSLint 項目，跟 ESLint 合並
- 為 Babel 開發語法插件支持 TypeScript 編譯等

所以在現代 Web 開發的項目中
- JS 和 TS 正在融合過程中，不可能完全排除其中一種
  - 甚至很多時候需要混用

混合語言開發的需求的增長，同時受到了來自 DX 和 UX 兩個方向的驅動，比如：
- 需要考慮到 Node.js 特有的一些語言特性（DX 驅動）
- 需要用 Rust 開發 CPU 敏感的模塊生成 WebAssembly 集成到項目中（UX 驅動）
- 需要在局部模塊引入 Reason/OCaml 的函數式編程能力（DX 驅動）

![105e103449c3b0427acc395de632887d_720w](https://pic2.zhimg.com/80/v2-105e103449c3b0427acc395de632887d_720w.jpg)  

### 第二個功能: CSS 開發解決方案

CSS 開發的發展趨勢就像下圖時間軸中列舉的這樣  
![7026f490cda80daf484aad9362868cb3_720w](https://pic4.zhimg.com/80/v2-7026f490cda80daf484aad9362868cb3_720w.jpg)  

- 從『面向文檔』向『面向組件』發展
- 『面向組件的 CSS』是一種同時改進 DX 和 UX 的模式
  - 在給 CSS 帶來完善工程能力的同時，能生成盡可能高效的 CSS 靜態文件

CSS Modules、styled-components、Functional CSS，這三個方案表面上看差別很大
- 一個是預編譯 CSS 文件
- 一個是 CSS in JS
- 一個是全局的 utility class

但本質上這三個方案都是在實現『面向組件的 CSS』  
從今年的 CSS 普查報告上，也能看到 Functional CSS 的流行  

### 第三個功能: 對 monorepo 的支持

monorepo 這種模式目前還主要用在庫的開發中
- 比如 Babel 這樣有大量子項目的倉庫，但其實現代 Web 開發中的多數項目，都能從中受益

我們團隊的倉庫
- 同一個產品的多個組成部分
  - 比如多個 SPA 應用、多頁網站、落地頁和活動頁，可以在一個倉庫里共享工程環境，方便的覆用程式碼，
- BFF 的開發也可以在同一個倉庫，跟客戶端共用一些程式碼


### 第四個功能: 對「微前端」的支持
微前端正好是一種兼顧 DX 和 UX 的設計模式
- 在用戶體驗這邊，可以做到完全無感知無差別，仍然是一個完整的 SPA 應用
- 第一屏無論包含多少微前端，都可以通過 SSR/SPR 和邊緣計算提供最好的加載速度和體驗
- 而第一屏不包含的微前端，可以按需加載，不會影響跟自己不相關的其他微前端
- 不同微前端之間可能彼此獨立，也可能有數據交互，需要打通應用狀態

以上用戶體驗雖然都能夠實現
- 但如果沒有元框架的支持，成本會比較高，容易顧此失彼，解決方案之間的不一致也會影響效果

在開發者體驗這邊
- 恰好可以為前面說的「垂直分工模式」提供支持
- 所有不同類型需求的前端部分，而是每個業務、每個垂直領域有自己獨立的團隊（或開發者）負責
  - 開發環境、開發過程、部署流程等完全彼此獨立自己掌控
- 但最終交付給用戶的時候仍然是一個完整單一體驗的應用

![760efb277f6a7567d27f19879375ae22_720w](https://pic3.zhimg.com/80/v2-760efb277f6a7567d27f19879375ae22_720w.jpg)  

### 第五個功能: 就是前面說過的「應用架構」

初級的現代 Web 項目只是在視圖層之外增加了應用狀態管理
- 比如 React 社區中主流的 Redux

但 Redux 實際上是一種「底層 API」，主要提供「機制」，並不提供「架構」的設計和實現
- 「架構」本身是一種頂層抽象，而 Redux 恰好是缺乏抽象的
- 近年社區里流行的「Rethinking Redux」、「Replacing Redux」的根源之一其實也是這個問題

元框架無論是否借助上遊項目，都要負責提供頂層抽象
- 比如 Component、Model、Container 鐵三角加上 App 入口，既為開發者提供開箱即用的應用架構
- 反過來也掌握了關於應用項目程式碼的「架構知識」，能從抽象角度理解程式碼，進一步提供有利於 UX 和 DX 的能力

元框架還可以從更高的項目視角來看待「應用架構」，結合框架其他部分提供更強能力
- 比如把項目入口的運行和部署方式、微前端模式和基礎設施跟應用架構打通

### 第六個功能可以稱作: 「智能助手」

軟件開發方式已經經歷了「基於文本」和「基於結構」兩個發展階段
- 在第一階段，開發工具能理解和處理的是文件、行和文本流
- 第二階段，開發工具能更多的把程式碼理解為結構化的信息
- 當前正在發展中的「第三階段」是「基於智能」

開發工具能更智能的理解程式碼、查看程式碼和生成程式碼，最終會趨向一個「智能助手」
- 開發的過程越來越不再是直接用源程式碼跟機器打交道，而是跟「智能助手」溝通
  - 獲得最好的 DX，智能助手再去跟機器打交道，實現最好的 UX

這種範式轉變已經在發生
- 在開發流程中引入了 Prettier，你手寫的程式碼就不再是源程式碼本身
  - 而是用來跟 Prettier 溝通的程式碼，最終提交到的源程式碼，是 Prettier 重新「寫」出來的

ESLint 也把 autofix 作為最重要的發展方向來推進
- 能自動修覆的規則已經越來越多
- 但是跟 Prettier 相比還是有範式上的差別

如果設置了 80 字符的最大行寬
- ESLint 和 Prettier 都能修改程式碼自動換行
- 但經過 ESLint 自動修覆後，程式碼還是可以有多種寫法，只有不觸發 ESLint 規則報錯就行
- 而 Prettier 處理後的程式碼只可能有一種寫法，因為程式碼是它「寫」的

所以 Prettier 以及「智能助手」
- 是一種「有偏見」的範式
- 對於 Prettier 怎樣「寫」程式碼，開發者的話語權很少（能配置的地方很少）
  - 如果你先憑空寫好一套程式碼規範，再用 Prettier 來實現，是不可能的
  - 但正是這種「偏見」才能給 DX 和 UX 同時帶來最大化的收益

智能助手
- 的發展是需要一個過程

在這個過程中
- 最佳實踐是把新舊範式整合在一起使用
- 隨著相關工具的進步，逐步在越來越多的地方把舊範式切換成新範式
  - 比如使用 Prettier 的最佳實踐就是把它作為規則插件整合在 ESLint 中
  - 跟 ESLint 的 autofix 一起執行

智能助手
- 的使用應該是基於即時反饋的
  - 而不是在編譯構建、提交倉庫、CI/CD 等環節
- 每次保存程式碼都是跟智能助手的一次「溝通」，立刻看到它生成的程式碼
  - 在這些程式碼基礎上繼續再做「溝通」，這樣的過程是符合直覺的，不會帶來「驚喜」

### 第七個功能: 對設計系統的支持

設計系統不止要提供「組件庫」
- 還需要提供組件之間的關系（包括組件的用法，設計規範等等）

用 Atomic Design 的概念來說，不可拆分的「原子組件」、以及由「原子組件」組合成的「分子組件」，共同構成「組件庫」，但整套系統還包含了建立在組件庫之上、包含組件之間關系的「有機體」



## 第三個趨勢: Web 形態的一個發展方向

今天的互聯網技術是 80 年代設計的，這套技術非常簡單成功，但因為缺少一些重要元素，導致今天的互聯網面臨很多難以解決的問題
- 其中一個重要缺失就是沒有「持有狀態」和「轉移狀態」的原生機制
  - 導致狀態只能存儲在少數中心節點，由這些節點在黑箱中處理狀態轉移

於是互聯網越來越「多中心化」
- 從開放互聯的狀態，收斂成少數幾個中心
- 由不同的科技巨頭控制，彼此難以聯通或直接敵對，前面提到的對科技巨頭產品的不信任也由此而來

用戶
- 對自己的個人數據（狀態的一種）缺乏掌控
  - 無法參與由數據產生的越來越多財富的分配
  - 缺少激勵或補償，減少了在生活中使用互聯網產品的積極性
  - （中國很多面向下沈市場的產品會人為提供遊戲化的激勵或補償，因此能飛速增長）
- 同時因為對黑箱缺乏信任，也進一步降低了積極性，或人為增加監管和限制。

這種扭曲
- 最終反噬互聯網產品和科技公司，讓他們難以為用戶創造價值
- 這個話題看上去很大，但是跟現代 Web 開發者是有關系的

所以 Web 形態的發展
- 有很大動力引入像 smart contract 和區塊鏈這樣的架構和範式上的轉變

現代 Web 應用的後端不再是中心化的服務器端 API
- 而是部署和運行在區塊鏈上的 smart contract  API，狀態存儲在去中心化基礎設施（區塊鏈）上，
- 由去中心化程序（ smart contract ）負責狀態轉移

這個現代 Web 應用也就成為了去中心化應用（DApp）
- 這種範式轉變不但不會顛覆當前的發展和積累，反而會促進原有的趨勢更快發展
- 比如基於 smart contract 的應用架構就是一種 Serverless 架構

但是產品的形態和機制會有很大改變
